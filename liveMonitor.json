const { exec } = require('child_process');
const fs = require('fs');
const path = require('path');

// ðŸ”— List all app folders you want to control here:
const apps = ['Vault360', 'SkyLink360', 'CoreEngineerAI'];

apps.forEach(app => {
  const appPath = path.join(__dirname, app);
  const packageJsonPath = path.join(appPath, 'package.json');

  if (!fs.existsSync(packageJsonPath)) {
    console.log(`âŒ Skipping ${app}: No package.json found.`);
    return;
  }

  console.log(`ðŸ“¦ Installing dependencies for ${app}...`);
  exec(`cd ${appPath} && npm install`, (installErr) => {
    if (installErr) {
      console.error(`ðŸš¨ Failed to install ${app}:`, installErr);
      return;
    }
    console.log(`âœ… Installed ${app}`);

    console.log(`ðŸš€ Starting ${app}...`);
    exec(`cd ${appPath} && npm start`, (startErr) => {
      if (startErr) {
        console.error(`ðŸš¨ Failed to start ${app}:`, startErr);
        return;
      }
      console.log(`âœ… Running ${app}`);
    });
  });
});

{
  "status": "idle",
  "apps": {
    "Vault360": "waiting",
    "SkyLink360": "waiting",
    "CoreEngineerAI": "waiting"
  }
}

{
  "status": "idle",
  "apps": {
    "Vault360": "waiting",
    "SkyLink360": "waiting",
    "CoreEngineerAI": "waiting"
  }
}
